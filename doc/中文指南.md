# paper-feedder-mcp æ¡†æ¶æŒ‡å—

> æœ¬æ–‡æ¡£ä¸º AI agent åŠäººç±»å¼€å‘è€…æä¾› paper-feedder-mcp ä»£ç åº“çš„å…¨é¢è¯´æ˜ï¼šæ¶æ„ã€è§„èŒƒã€æ•°æ®æµä¸çº¦æŸã€‚

---

## 1. é¡¹ç›®æ¦‚è¿°

**paper-feedder-mcp** æ˜¯ä¸€ä¸ªæ¨¡å—åŒ– Python æ¡†æ¶ï¼Œç”¨äºä» RSS è®¢é˜…æºå’Œ Gmail é‚®ä»¶æé†’ä¸­æ”¶é›†ã€è¿‡æ»¤å’Œå¯¼å‡ºå­¦æœ¯è®ºæ–‡ã€‚

- **è¯­è¨€**: Python 3.12+
- **å¼‚æ­¥ä¼˜å…ˆ**: æ‰€æœ‰ I/O æ“ä½œä½¿ç”¨ `async/await`
- **åŒ…ç®¡ç†å™¨**: `uv`ï¼ˆé”æ–‡ä»¶: `uv.lock`ï¼‰ï¼Œæ„å»ºåç«¯: `hatchling`
- **ä»£ç æ£€æŸ¥/æ ¼å¼åŒ–**: `ruff`ï¼ˆè¡Œå®½ 88ï¼Œç›®æ ‡ py312ï¼‰
- **ç±»å‹æ£€æŸ¥**: `ty`ï¼ˆRed Knotï¼‰
- **æµ‹è¯•**: `pytest` + `pytest-asyncio`ï¼ˆæ¨¡å¼: `auto`ï¼‰
- **æ•°æ®æ¨¡å‹**: `pydantic` v2ï¼ˆ`BaseModel`ï¼‰

### é¡¹ç›®çŠ¶æ€ï¼ˆ2026-02-09ï¼‰

âœ… **å·²å®ŒæˆåŠŸèƒ½**:
- RSS æºå¹¶å‘æŠ“å–ï¼ˆ94ä¸ªå­¦æœ¯æœŸåˆŠæºï¼‰
- Gmail é‚®ä»¶è§£æï¼ˆæ”¯æŒ Google Scholarã€æœŸåˆŠ TOC é‚®ä»¶ï¼‰
- ä¸¤çº§è¿‡æ»¤ç³»ç»Ÿï¼ˆAI ç”Ÿæˆå…³é”®è¯ + AI è¯­ä¹‰ç²¾é€‰ï¼‰
- CrossRef/OpenAlex å…ƒæ•°æ®è¡¥å……
- JSON/Zotero å¯¼å‡º
- å®Œæ•´ CLI å·¥å…·é“¾
- å•å…ƒæµ‹è¯•ï¼š346 é€šè¿‡ï¼Œ2 è·³è¿‡

ğŸ“‹ **å½“å‰é…ç½®**:
- æ”¯æŒ Natureã€Scienceã€ACSã€Wileyã€RSCã€Elsevierã€IOP ç­‰ä¸»æµæœŸåˆŠ
- AI è¿‡æ»¤ä½¿ç”¨ DeepSeek/OpenAI å…¼å®¹ API
- æ‰€æœ‰æ•æ„Ÿé…ç½®é€šè¿‡ `.env` ç®¡ç†

### æ›´æ–°å†å²

**v2.1.1 (2026-02-09)**
- âœ… ç‰ˆæœ¬å·ç»Ÿä¸€åœ¨ `pyproject.toml` ç®¡ç†
- âœ… æ–‡æ¡£å‚æ•°ä¸ç›®å½•ç»“æ„æ›´æ–°ï¼ˆenrich å‚æ•°åˆ«åã€doc è·¯å¾„ï¼‰
- âœ… æ¸…ç†ä¸­é—´æ–‡ä»¶å¹¶å®Œå–„ `.gitignore`ï¼ˆå¿½ç•¥ `cache/`ï¼‰

**v1.1.1 (2026-02-08)**
- âœ… PaperItem æ‰©å±•è‡³å®Œæ•´ Zotero journalArticle å­—æ®µï¼ˆpublication_title, publisher, volume, issue, pages, issn, language ç­‰ 20+ å­—æ®µï¼‰
- âœ… `metadata` å­—æ®µé‡å‘½åä¸º `extra`ï¼ˆè¯­ä¹‰æ›´æ¸…æ™°ï¼Œé¿å…ä¸ Pydantic å†…éƒ¨å†²çªï¼‰
- âœ… RSS å»é‡å‡çº§ä¸ºä¸‰çº§ä¼˜å…ˆçº§ï¼šDOIï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰> URL > æ ‡é¢˜ï¼ˆæ¨¡ç³ŠåŒ¹é…ï¼Œå»é™¤ ASAP ç­‰å™ªå£°è¯ï¼‰
- âœ… CrossRef å¯ŒåŒ–ç­–ç•¥å˜æ›´ä¸º**è¦†ç›–**æ‰€æœ‰å­—æ®µï¼ˆæœ€æƒå¨æ¥æºï¼‰
- âœ… OpenAlex å¯ŒåŒ–ç­–ç•¥ä¿æŒ**ä»…è¡¥å……ç¼ºå¤±**å­—æ®µ
- âœ… ä¸¤ä¸ª API çš„æœªæ˜ å°„å­—æ®µå­˜å…¥ `extra["crossref_extra"]` / `extra["openalex_extra"]`
- âœ… CLI enrich å‘½ä»¤ï¼šOpenAlex å§‹ç»ˆè¿è¡Œï¼ˆä¸å†å›  CrossRef å·²è¡¥å……è€Œè·³è¿‡ï¼‰
- âœ… Zotero é€‚é…å™¨æ˜ å°„æ‰€æœ‰æ–°å¢å­—æ®µ

**v1.0.0 (2026-02-07)**
- âœ… å®Œæˆæ¡†æ¶æ ¸å¿ƒåŠŸèƒ½
- âœ… æ‰€æœ‰ CLI å‘½ä»¤æµ‹è¯•é€šè¿‡
- âœ… æ–‡æ¡£å®Œå–„ï¼ˆä¸­æ–‡æŒ‡å— + READMEï¼‰
- âœ… å…³é”®è¯è¿‡æ»¤é€»è¾‘ç¡®è®¤ä¸º ORï¼ˆè€Œé ANDï¼‰
- âœ… AI è¿‡æ»¤æ¨¡å—ä» `ai/` ç§»åŠ¨åˆ° `filters/` ä»¥æ›´ç¬¦åˆé€»è¾‘åˆ†å±‚
- âœ… æ¸…ç†æ‰€æœ‰ç¼“å­˜å’Œä¸´æ—¶æ–‡ä»¶
- âœ… .gitignore é…ç½®å®Œå–„

**v0.9.0 (2026-02-06)**
- åˆå§‹æ¡†æ¶å®ç°
- åŸºç¡€æµ‹è¯•è¦†ç›–

---

## 2. å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¸é…ç½®

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd paper-feedder-mcp

# 2. å®‰è£…ä¾èµ–
uv sync

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè‡³å°‘é…ç½®ï¼š
# - OPENAI_API_KEYï¼ˆç”¨äº AI è¿‡æ»¤ï¼‰
# - POLITE_POOL_EMAILï¼ˆç”¨äºå…ƒæ•°æ®è¡¥å……ï¼‰

# 4. éªŒè¯å®‰è£…
uv run paper-feedder-mcp --help
```

### 5 åˆ†é’Ÿå¿«é€Ÿä½“éªŒ

```bash
# æ­¥éª¤ 1: è·å– 20 ç¯‡æœ€æ–°è®ºæ–‡ï¼ˆé»˜è®¤è¿‘15å¤©ï¼‰
uv run paper-feedder-mcp fetch --source rss --limit 20 --output output/papers.json

# æ­¥éª¤ 2: ç”¨å…³é”®è¯è¿‡æ»¤ï¼ˆæ›¿æ¢ä¸ºä½ çš„ç ”ç©¶é¢†åŸŸå…³é”®è¯ï¼‰
uv run paper-feedder-mcp filter --input output/papers.json --output output/filtered.json \
    --keywords battery energy chemistry

# æ­¥éª¤ 3: æŸ¥çœ‹ç»“æœ
cat output/filtered.json | python -m json.tool | head -30

# æ­¥éª¤ 4: å¯¼å‡ºï¼ˆå¯é€‰ï¼Œé»˜è®¤åŒ…å«æ‰©å±•å­—æ®µï¼‰
uv run paper-feedder-mcp export --input output/filtered.json --output output/final.json \
    --format json
```

### å®Œæ•´å·¥ä½œæµç¨‹ï¼ˆæ¨èï¼‰

```bash
# 1. è·å–è®ºæ–‡ï¼ˆä» 94 ä¸ªå­¦æœ¯æœŸåˆŠæºï¼Œé»˜è®¤è¿‘15å¤©ï¼‰
uv run paper-feedder-mcp fetch --source rss --limit 100 --output output/raw.json

# 2. ç¬¬ä¸€çº§è¿‡æ»¤ï¼šå…³é”®è¯ï¼ˆå®½ç­›ï¼‰
uv run paper-feedder-mcp filter --input output/raw.json --output output/keyword_filtered.json \
    --keywords battery electrode energy storage

# 3. ç¬¬äºŒçº§è¿‡æ»¤ï¼šAI è¯­ä¹‰ï¼ˆç²¾é€‰ï¼Œé»˜è®¤å¼€å¯ï¼‰- éœ€é…ç½® OPENAI_API_KEY å’Œ RESEARCH_PROMPT
uv run paper-feedder-mcp filter --input output/keyword_filtered.json --output output/ai_filtered.json

# 4. å…ƒæ•°æ®è¡¥å……ï¼ˆDOIã€ä½œè€…ã€æ‘˜è¦ç­‰ï¼‰
uv run paper-feedder-mcp enrich --input output/ai_filtered.json --output output/enriched.json \
    --api all --concurrency 5

# 5. æœ€ç»ˆå¯¼å‡ºï¼ˆé»˜è®¤åŒ…å«æ‰©å±•å­—æ®µï¼‰
uv run paper-feedder-mcp export --input output/enriched.json --output output/final_papers.json \
    --format json

# 6. æ¸…ç†è¾“å‡ºï¼ˆå¯é€‰ï¼‰
uv run paper-feedder-mcp delete
```

---

## 3. ç›®å½•ç»“æ„

```
paper-feedder-mcp/
â”œâ”€â”€ pyproject.toml             # é¡¹ç›®é…ç½®ã€ä¾èµ–ã€å·¥å…·è®¾ç½®
â”œâ”€â”€ README.md                  # é¢å‘ç”¨æˆ·çš„æ–‡æ¡£ï¼ˆè‹±æ–‡ï¼‰
â”œâ”€â”€ doc/ä¸­æ–‡æŒ‡å—.md           # â† æœ¬æ–‡ä»¶ï¼ˆæ¡†æ¶æŒ‡å—ï¼‰
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore                 # Git å¿½ç•¥æ–‡ä»¶
â”‚
â”œâ”€â”€ src/                       # ä¸»åŒ…ï¼ˆMCP Serverï¼‰
â”‚   â”œâ”€â”€ __init__.py            # ä¸»å…¥å£å¯¼å‡º
â”‚   â”œâ”€â”€ __main__.py            # python -m src
â”‚   â”œâ”€â”€ server.py              # MCP server entryï¼ˆstdioï¼‰
â”‚   â”œâ”€â”€ client/                # CLIï¼ˆé»˜è®¤ serve + å­å‘½ä»¤ï¼‰
â”‚   â”‚   â””â”€â”€ cli.py
â”‚   â”œâ”€â”€ config/                # é…ç½®ï¼ˆpydantic-settingsï¼‰
â”‚   â”‚   â””â”€â”€ settings.py
â”‚   â”œâ”€â”€ handlers/              # MCP tools / prompts
â”‚   â”‚   â”œâ”€â”€ tools.py
â”‚   â”‚   â””â”€â”€ prompts.py
â”‚   â”œâ”€â”€ models/                # æ¶æ„æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ responses.py       # PaperItem ç­‰æ ¸å¿ƒå®ä½“
â”‚   â”‚   â”œâ”€â”€ schemas.py         # MCP è¾“å…¥ schema
â”‚   â”‚   â””â”€â”€ enums.py           # ToolName enum
â”‚   â”œâ”€â”€ services/              # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ fetch.py
â”‚   â”‚   â”œâ”€â”€ filter.py
â”‚   â”‚   â”œâ”€â”€ enrich.py
â”‚   â”‚   â””â”€â”€ export.py
â”‚   â”œâ”€â”€ sources/               # æ•°æ®æºå®ç°
â”‚   â”œâ”€â”€ filters/               # è¿‡æ»¤ç®¡é“
â”‚   â”œâ”€â”€ adapters/              # å¯¼å‡ºé€‚é…å™¨
â”‚   â”œâ”€â”€ ai/                    # AI æ¨¡å—
â”‚   â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°ï¼ˆtext / errorsï¼‰
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ unit/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ test_rss_source.py     # RSSSource + OPMLParser æµ‹è¯•
â”‚       â”œâ”€â”€ test_gmail_source.py   # GmailSource æµ‹è¯•
â”‚       â”œâ”€â”€ test_gmail_parser.py   # GmailParser HTML è§£ææµ‹è¯•
â”‚       â”œâ”€â”€ test_adapters.py       # JSONAdapter + ZoteroAdapter æµ‹è¯•
â”‚       â”œâ”€â”€ test_filters.py        # FilterPipeline + KeywordFilterStage æµ‹è¯•
â”‚       â”œâ”€â”€ test_config.py         # é…ç½®ç®¡ç†æµ‹è¯•
â”‚       â”œâ”€â”€ test_cli.py            # CLI æ¥å£æµ‹è¯•
â”‚       â”œâ”€â”€ test_ai.py             # AI æ¨¡å—æµ‹è¯•ï¼ˆKeywordGenerator + AIFilterStageï¼‰
â”‚       â”œâ”€â”€ test_crossref.py       # CrossrefClient æµ‹è¯•
â”‚       â”œâ”€â”€ test_openalex.py       # OpenAlexClient æµ‹è¯•
â”‚       â””â”€â”€ test_pipeline_ai.py    # ç®¡é“ä¸ AI é˜¶æ®µé›†æˆæµ‹è¯•
â”‚
â””â”€â”€ feeds/
    â””â”€â”€ RSS_official.opml      # é»˜è®¤ OPML æ–‡ä»¶ï¼ˆå­¦æœ¯ RSS è®¢é˜…æºï¼‰
```

---

## 4. æ¶æ„ä¸æ•°æ®æµ

### åˆ†å±‚æ¶æ„

```
MCP Client / CLI (cli.py)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 MCP Server (server.py)          â”‚
â”‚  list_tools / call_tool / list_prompts /        â”‚
â”‚  get_prompt                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Handlers (tools.py / prompts.py)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Services (fetch/filter/enrich/export)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
   â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â–¼    â–¼            â–¼            â–¼
Sources  Filters      AI        Adapters
   â”‚       â”‚          â”‚           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–¼
      Core Models
  (PaperItem, FilterCriteria, FilterResult)
```

### MCP å·¥å…·è¾“å‡ºæ ¼å¼

æ‰€æœ‰ MCP å·¥å…·ç»Ÿä¸€è¿”å› JSON åŒ…è£…æ ¼å¼ï¼š

```json
{
  "ok": true,
  "data": {
    "...": "..."
  },
  "meta": {
    "...": "..."
  }
}
```

å‡ºé”™æ—¶ï¼š

```json
{
  "ok": false,
  "error": "ErrorType: message"
}
```

### æ•°æ®æµï¼ˆä¸»ç®¡é“ï¼‰

```
Source.fetch_papers()  â†’  List[PaperItem]
        â”‚
        â–¼
FilterPipeline.filter(papers, criteria)  â†’  FilterResult
        â”‚
        â–¼
Enrichment (CrossrefClient / OpenAlexClient)  â†’  List[PaperItem]ï¼ˆè¡¥å……åï¼‰
        â”‚
        â–¼
Adapter.export(filtered_papers)  â†’  è¾“å‡ºæ–‡ä»¶ / API
```

### è¯¦ç»†æµç¨‹

```
CLI (fetch --source rss) â†’ RSSSource
    â”œâ”€ OPMLParser.parse() â†’ List[{url, title, category}]
    â”œâ”€ httpx.AsyncClient.get(url)  Ã—  asyncio.Semaphore(max_concurrent)
    â”œâ”€ asyncio.to_thread(feedparser.parse, content) â†’ feed
    â”œâ”€ RSSParser.parse(entry, source_name, feed_meta) â†’ PaperItem
    â””â”€ å»é‡ï¼ˆurl or titleï¼‰ â†’ List[PaperItem]

CLI (fetch --source gmail) â†’ GmailSource
    â”œâ”€ _write_json_configs()  â†’  feeds/token.json + feeds/credentials.jsonï¼ˆä»…åœ¨å†…è” JSON æ¨¡å¼ï¼‰
    â”œâ”€ ezgmail.init() â†’ ezgmail.search(query, maxResults)
    â”œâ”€ _extract_html_body(message.messageObj)  â†’  HTML
    â”œâ”€ GmailParser.parse(html, source_name) â†’ List[PaperItem]
    â”œâ”€ _extract_from_plain_text()ï¼ˆHTML ä¸å¯ç”¨æ—¶çš„ DOI æ­£åˆ™å›é€€ï¼‰
    â””â”€ _deduplicate(title) â†’ List[PaperItem]

CLI (filter) â†’ FilterPipeline(llm_client?)
    â”œâ”€ Stage 1: KeywordFilterStage
    â”‚   â”œâ”€ exclude_keywords â†’ OR æ’é™¤
    â”‚   â”œâ”€ keywords â†’ OR åŒ¹é…ï¼ˆä¸€çº§å®½ç­›é€‰ï¼‰
    â”‚   â”œâ”€ authors â†’ OR åŒ¹é…
    â”‚   â”œâ”€ has_pdf â†’ pdf_url æ£€æŸ¥
    â”‚   â””â”€ min_date â†’ published_date æ£€æŸ¥
    â”œâ”€ Stage 2: AIFilterStageï¼ˆå¯é€‰ï¼Œéœ€ llm_clientï¼‰
    â”‚   â”œâ”€ åˆ†æ‰¹ï¼ˆ50 ç¯‡/æ‰¹ï¼‰â†’ ä¸­æ–‡ prompt â†’ LLM API
    â”‚   â””â”€ è§£æ JSON {"relevant": [...]} â†’ ç´¢å¼•éªŒè¯
    â””â”€ FilterResult { papers, total_count, passed_count, rejected_count, filter_stats }

CLI (enrich --api all) â†’ CrossrefClient + OpenAlexClient
    â”œâ”€ æ¯ç¯‡è®ºæ–‡ï¼ˆasyncio.Semaphore(concurrency)ï¼‰:
    â”‚   â”œâ”€ CrossRef: DOI â†’ æ ‡é¢˜ â†’ URLï¼ˆä¼˜å…ˆ DOIï¼›è¦†ç›–å·²æœ‰å­—æ®µï¼‰
    â”‚   â””â”€ OpenAlex: DOI â†’ æ ‡é¢˜ â†’ URLï¼ˆåªè¡¥å……ç¼ºå¤±å­—æ®µï¼‰
    â””â”€ åªè¡¥å……ç¼ºå¤±å­—æ®µï¼Œé¢å¤–å…ƒæ•°æ® â†’ extra["crossref"] / extra["openalex"]

CLI (export) â†’ JSONAdapter / ZoteroAdapter
    â”œâ”€ JSONAdapter.export() â†’ JSON æ–‡ä»¶ï¼ˆmodel_dump, dateâ†’ISO, indent=2ï¼‰
    â””â”€ ZoteroAdapter.export() â†’ Zotero APIï¼ˆjournalArticle æ ¼å¼ï¼‰
```

---

## 5. æ ¸å¿ƒç»„ä»¶å‚è€ƒ

### 4.1 PaperItemï¼ˆPydantic BaseModelï¼‰

é€šç”¨è®ºæ–‡è¡¨ç¤ºï¼Œå¯¹é½ Zotero journalArticle schemaã€‚æ‰€æœ‰æ•°æ®æºäº§å‡ºæ­¤å¯¹è±¡ï¼›æ‰€æœ‰é€‚é…å™¨æ¶ˆè´¹æ­¤å¯¹è±¡ã€‚

```python
class PaperItem(BaseModel):
    # --- æ ¸å¿ƒå­—æ®µï¼ˆå¿…å¡«ï¼‰ ---
    title: str                                          # è®ºæ–‡æ ‡é¢˜
    source: str                                         # æ¥æºåç§°ï¼ˆå¦‚ "Nature", "ACS"ï¼‰
    source_type: str                                    # "rss" æˆ– "email"

    # --- æ–‡çŒ®ä¿¡æ¯å­—æ®µï¼ˆå¯é€‰ï¼‰ ---
    authors: List[str] = Field(default_factory=list)    # ä½œè€…å§“ååˆ—è¡¨
    abstract: str = Field(default="")                   # æ‘˜è¦/æ¦‚è¦
    published_date: Optional[date] = None               # å‘è¡¨æ—¥æœŸ
    doi: Optional[str] = None                           # DOIï¼ˆæ— å‰ç¼€ï¼‰
    url: Optional[str] = None                           # è®ºæ–‡ URL
    pdf_url: Optional[str] = None                       # PDF ç›´é“¾
    publication_title: Optional[str] = None             # æœŸåˆŠå
    journal_abbreviation: Optional[str] = None          # æœŸåˆŠç¼©å†™
    publisher: Optional[str] = None                     # å‡ºç‰ˆå•†
    place: Optional[str] = None                         # å‡ºç‰ˆåœ°
    volume: Optional[str] = None                        # å·å·
    issue: Optional[str] = None                         # æœŸå·
    pages: Optional[str] = None                         # é¡µç èŒƒå›´ï¼ˆå¦‚ "123-145"ï¼‰
    section: Optional[str] = None                       # æ–‡ç« åˆ†åŒº
    part_number: Optional[str] = None                   # éƒ¨åˆ†ç¼–å·
    part_title: Optional[str] = None                    # éƒ¨åˆ†æ ‡é¢˜
    series: Optional[str] = None                        # ç³»åˆ—åç§°
    series_title: Optional[str] = None                  # ç³»åˆ—æ ‡é¢˜
    series_text: Optional[str] = None                   # ç³»åˆ—æ–‡æœ¬
    citation_key: Optional[str] = None                  # å¼•ç”¨é”®
    access_date: Optional[date] = None                  # è®¿é—®æ—¥æœŸ
    pmid: Optional[str] = None                          # PubMed ID
    pmcid: Optional[str] = None                         # PubMed Central ID
    issn: Optional[str] = None                          # ISSN
    archive: Optional[str] = None                       # æ¡£æ¡ˆå
    archive_location: Optional[str] = None              # æ¡£æ¡ˆä½ç½®
    short_title: Optional[str] = None                   # ç®€çŸ­æ ‡é¢˜
    language: Optional[str] = None                      # è¯­è¨€
    library_catalog: Optional[str] = None               # å›¾ä¹¦é¦†ç›®å½•æ¥æº
    call_number: Optional[str] = None                   # ç´¢ä¹¦å·
    rights: Optional[str] = None                        # ç‰ˆæƒ/è®¸å¯
    item_type: str = "journalArticle"                   # æ¡ç›®ç±»å‹

    # --- å†…éƒ¨å­—æ®µ ---
    source_id: Optional[str] = None                     # æ¥æºç‰¹å®š ID
    extra: Dict[str, Any] = Field(default_factory=dict) # æ‰©å±•æ•°æ®ï¼ˆå¯ŒåŒ–å…ƒæ•°æ®ã€feed ä¿¡æ¯ç­‰ï¼‰
```

**çº¦æŸï¼š**
- `title`ã€`source` å’Œ `source_type` å§‹ç»ˆå¿…å¡«
- `doi` å¯é€‰ï¼ˆ`None`ï¼‰ï¼Œä¸æ˜¯ç©ºå­—ç¬¦ä¸² â€” enrichment é˜¶æ®µå¯èƒ½è¡¥å……
- `extra` æ˜¯æ‰©å±•æ•°æ®å­—æ®µ â€” ç”¨äºå­˜å‚¨ API å¯ŒåŒ–çš„é¢å¤–å…ƒæ•°æ®ï¼ˆå¦‚ `extra["crossref"]`ã€`extra["openalex"]`ã€`extra["feed"]`ï¼‰
- æ–‡çŒ®ä¿¡æ¯å­—æ®µï¼ˆvolume, issue, pages ç­‰ï¼‰ç”± CrossRef/OpenAlex ç›´æ¥æ˜ å°„ï¼Œä¸å†å­˜æ”¾äº `extra` ä¸­
- æ‰€æœ‰å¯å˜ç±»å‹çš„é»˜è®¤å€¼ä½¿ç”¨ `Field(default_factory=...)`ï¼Œä¸ä½¿ç”¨ `= []` æˆ– `= {}`

### 4.2 PaperSourceï¼ˆABCï¼‰

```python
class PaperSource(ABC):
    source_name: str = "base"
    source_type: str = "base"

    @abstractmethod
    async def fetch_papers(
        self, limit: Optional[int] = None, since: Optional[date] = None
    ) -> List[PaperItem]: ...
```

**å®ç°ç±»ï¼š** `RSSSource`, `GmailSource`

### 4.3 ExportAdapterï¼ˆABCï¼‰

```python
class ExportAdapter(ABC):
    @abstractmethod
    async def export(self, papers: List[PaperItem], **kwargs: Any) -> Any: ...
```

**å®ç°ç±»ï¼š** `JSONAdapter`, `ZoteroAdapter`

### 4.4 FilterCriteria ä¸ FilterResult

```python
class FilterCriteria(BaseModel):
    keywords: List[str] = []           # OR é€»è¾‘ â€” ä»»ä¸€åŒ¹é…å³é€šè¿‡ï¼ˆä¸€çº§å®½ç­›é€‰ï¼‰
    exclude_keywords: List[str] = []   # NOT é€»è¾‘ â€” ä»»ä¸€åŒ¹é…åˆ™æ’é™¤
    min_date: Optional[date] = None
    authors: List[str] = []            # OR é€»è¾‘
    has_pdf: bool = False

class FilterResult(BaseModel):
    papers: List[PaperItem]
    total_count: int
    passed_count: int
    rejected_count: int
    filter_stats: Dict[str, Any] = {}
```

**é‡è¦**: `keywords` å­—æ®µä½¿ç”¨ **OR é€»è¾‘**ï¼Œè€Œé AND é€»è¾‘ã€‚è¿™ç¡®ä¿äº†ç¬¬ä¸€çº§è¿‡æ»¤ä¸ä¼šè¿‡äºä¸¥æ ¼ï¼Œé¿å…è¯¯æ€æ½œåœ¨ç›¸å…³è®ºæ–‡ã€‚

---

## 6. æ•°æ®æºå®ç°

### 5.1 RSSSource (`sources/rss.py`)

- **æ„é€ å‡½æ•°**: `RSSSource(opml_path?, user_agent?, timeout?, max_concurrent?)`
  - æ‰€æœ‰å‚æ•°å¯é€‰ï¼Œå›é€€åˆ° `get_rss_config()` â†’ ç¯å¢ƒå˜é‡ â†’ ç¡¬ç¼–ç é»˜è®¤å€¼
- **ä¾èµ–**: `feedparser`, `httpx`ï¼ˆå¼‚æ­¥ HTTPï¼‰, `OPMLParser`, `RSSParser`
- **å¹¶å‘æ§åˆ¶**: `asyncio.Semaphore(max_concurrent)` æ§åˆ¶å¹¶è¡ŒæŠ“å–ï¼ˆé»˜è®¤ 10ï¼‰
- **å»é‡**: æŒ‰ `paper.url or paper.title` è·¨æ‰€æœ‰è®¢é˜…æºå»é‡ï¼ˆURL ä¼˜å…ˆï¼Œæ—  URL æ—¶ç”¨æ ‡é¢˜ï¼‰
- **é”™è¯¯å¤„ç†**: å¤±è´¥çš„è®¢é˜…æºè®°å½•æ—¥å¿—å¹¶è·³è¿‡ï¼›`asyncio.gather(return_exceptions=True)`
- **æ¥æºåç§°æ£€æµ‹**: `_detect_source_name(url)` â€” URL æ¨¡å¼åŒ¹é…å·²çŸ¥å‡ºç‰ˆå•†åŸŸåï¼ˆnature.comâ†’"Nature"ã€acs.orgâ†’"ACS" ç­‰ï¼‰ï¼Œæœªå‘½ä¸­æ—¶ä»åŸŸåé¦–æ®µæ¨æ–­
- **å…¨å±€ limit**: èšåˆåæˆªæ–­ï¼Œ`all_papers[:limit]`

### 5.2 RSSParser (`sources/rss_parser.py`)

å°†å•ä¸ª feedparser entry å­—å…¸è½¬æ¢ä¸º `PaperItem`ã€‚æå–å†…å®¹ï¼š
- **æ ‡é¢˜**: `entry.title`ï¼ˆå¿…å¡«ï¼‰
- **ä½œè€…**: `entry.authors`ï¼ˆå­—å…¸/å¯¹è±¡åˆ—è¡¨ï¼Œå« `.name`ï¼‰â†’ å›é€€ `entry.author`ï¼ˆå­—ç¬¦ä¸²ï¼ŒæŒ‰ `,` / `;` / ` and ` åˆ†å‰²ï¼‰
- **æ‘˜è¦**: `entry.summary` â†’ å›é€€ `entry.description`
- **æ—¥æœŸ**: `entry.published_parsed` â†’ å›é€€ `entry.updated_parsed`ï¼ˆå‡ä¸º `time.struct_time`ï¼‰
- **DOI**: `entry.dc_identifier` / `entry.prism_doi` â†’ å›é€€åœ¨ `entry.link` / `entry.id` ä¸­ç”¨ DOI æ­£åˆ™åŒ¹é…
- **PDF URL**: `entry.links` ä¸­ `type="application/pdf"` â†’ `entry.pdf_url` â†’ arXiv `/abs/` â†’ `/pdf/` è½¬æ¢

### 5.3 GmailSource (`sources/gmail.py`)

- **æ„é€ å‡½æ•°**: `GmailSource(query?, source_name?, max_results?, mark_as_read?, auto_detect_source?, processed_label?, trash_after_process?)`
  - å…è®¸ä¸¤ç§å‡­æ®æ–¹å¼ï¼š
    - å·²æœ‰æ–‡ä»¶ï¼š`feeds/token.json` + `feeds/credentials.json`ï¼ˆé»˜è®¤ï¼‰
    - å†…è” JSONï¼š`GMAIL_TOKEN_JSON` / `GMAIL_CREDENTIALS_JSON`ï¼ˆä¼šå†™å…¥ä¸Šè¿°æ–‡ä»¶è·¯å¾„ï¼‰
  - è‹¥æ–‡ä»¶ä¸å†…è” JSON éƒ½ä¸å­˜åœ¨ï¼Œåˆ™æŠ› `ValueError`
- **ä¾èµ–**: `ezgmail`, `GmailParser`
- **å»¶è¿Ÿåˆå§‹åŒ–**: `_ensure_init()` â†’ `_write_json_configs()`ï¼ˆè‹¥æä¾›å†…è” JSON åˆ™å†™å…¥æ–‡ä»¶ï¼‰â†’ `ezgmail.init(tokenFile, credentialsFile)`
- **HTML æå–**: è‡ªå®šä¹‰ `_extract_html_body()` / `_find_html_in_payload()` â€” é€’å½’éå† `message.messageObj` payload æŸ¥æ‰¾ `TEXT/HTML` éƒ¨åˆ†å¹¶è¿›è¡Œ base64 è§£ç ã€‚**è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸º ezgmail åªæå–çº¯æ–‡æœ¬ã€‚**
- **çº¯æ–‡æœ¬å›é€€**: `_extract_from_plain_text()` â€” å½“æ—  HTML æ—¶ï¼Œä» `originalBody` / `body` ä¸­ç”¨ `DOI_PATTERN` æ­£åˆ™æå– DOI é“¾æ¥
- **å‘ä»¶äººè‡ªåŠ¨æ£€æµ‹**: `_detect_source_from_sender()` â€” é€šè¿‡ `GMAIL_SENDER_MAP_JSON` æ˜ å°„ï¼ˆå¦‚ `scholaralerts-noreply@google.com` â†’ "Google Scholar"ï¼‰è‡ªåŠ¨è®¾ç½®æ¥æºåç§°
- **å‘ä»¶äººç­›é€‰**: `GMAIL_SENDER_FILTER` ä½œä¸ºå…è®¸åˆ—è¡¨ï¼Œè¿‡æ»¤éç›®æ ‡å‘ä»¶äºº
- **å»é‡**: `_deduplicate()` â€” æŒ‰æ ‡é¢˜ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰è·¨æ‰€æœ‰é‚®ä»¶å»é‡
- **åŠŸèƒ½**: æ—¥æœŸè¿‡æ»¤ã€æ ‡è®°å·²è¯»ï¼ˆ`thread.markAsRead()`ï¼Œtrash å‰å¼ºåˆ¶æ‰§è¡Œï¼‰ã€å¤„ç†æ ‡ç­¾ï¼ˆ`message.addLabel()`ï¼‰ã€å¤±è´¥æ ‡è®°æœªè¯»ï¼ˆ`thread.markAsUnread()`ï¼‰ã€å¤„ç†æˆåŠŸåç§»å…¥å›æ”¶ç«™ï¼ˆ`thread.trash()`ï¼Œé»˜è®¤å¼€å¯ï¼‰
  - å¤„ç†å®Œæˆåé»˜è®¤æ‰§è¡Œ Trash æ ¸å¯¹æŸ¥è¯¢ï¼ˆ`in:trash`ï¼‰

### 5.4 GmailParser (`sources/gmail_parser.py`)

ä½¿ç”¨ä¸‰ç§ç­–ç•¥è§£æ HTML é‚®ä»¶å†…å®¹ï¼ˆæŒ‰é¡ºåºå°è¯•ï¼‰ï¼š
1. **è¡¨æ ¼è¡Œ**: æ‰«æ `<table>` â†’ `<tr>` è¡Œä¸­çš„æ–‡ç« é“¾æ¥ï¼ˆå¸¸è§äºæœŸåˆŠç›®å½•é‚®ä»¶ï¼‰
2. **Div/article/section**: æ‰«æ `<div>`, `<article>`, `<section>` å®¹å™¨ä¸­çš„é“¾æ¥ + æ ‡é¢˜
3. **ç‹¬ç«‹é“¾æ¥**: æ‰«ææ‰€æœ‰ `<a>` æ ‡ç­¾ï¼ŒæŒ‰å·²çŸ¥å‡ºç‰ˆå•†åŸŸåè¿‡æ»¤

æ¯ç§ç­–ç•¥æå–: æ ‡é¢˜ã€URLã€DOIï¼ˆæ­£åˆ™ï¼‰ã€ä½œè€…ï¼ˆå¯å‘å¼ï¼‰ã€æœŸåˆŠ/ç±»åˆ«ã€‚
ç»“æœæŒ‰æ ‡é¢˜ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰å»é‡ã€‚

### 5.5 OPMLParser (`sources/opml.py`)

è§£æ OPML XML æ–‡ä»¶ä»¥æå– RSS è®¢é˜…æº URLã€‚å¤„ç†ï¼š
- åµŒå¥—ç±»åˆ«ï¼ˆé€’å½’ `<outline>` éå†ï¼‰
- æå–æ¡ä»¶: `type="rss"` **ä¸”** `xmlUrl` å±æ€§å­˜åœ¨
- è¿”å› `List[Dict]`ï¼Œæ¯é¡¹åŒ…å« `url`ã€`title`ã€`html_url`ã€`category`
- ç±»åˆ«ä¿ç•™ï¼ˆä»çˆ¶çº§ outline çš„ `text` å±æ€§ç»§æ‰¿ï¼‰

### 5.6 CrossrefClient (`sources/crossref.py`)

- **ç”¨é€”**: CrossRef REST API å®¢æˆ·ç«¯ï¼Œç”¨äº DOI æŸ¥æ‰¾å’Œè®ºæ–‡å…ƒæ•°æ®è¡¥å……ã€‚
- **æ ¸å¿ƒç±»**: `CrossrefWork`ï¼ˆdataclassï¼‰â€” åŒ…å« doi, title, authorsï¼ˆ"Family, Given" æ ¼å¼ï¼‰, journal, year, abstract, citation_count, pdf_url ç­‰ 17 ä¸ªå­—æ®µã€‚
- **æ–¹æ³•**:
  - `search_by_title(title, rows=5)`: æŒ‰æ ‡é¢˜æœç´¢ï¼Œä½¿ç”¨ `select` å‚æ•°å‡å°‘å“åº”è´Ÿè½½ã€‚
  - `get_by_doi(doi)`: æŒ‰ DOI ç²¾ç¡®æŸ¥æ‰¾ã€‚
  - `find_best_match(title, threshold=0.8)`: Jaccard ç›¸ä¼¼åº¦ï¼ˆè¯é›†äº¤/å¹¶ï¼‰åŒ¹é…æœ€ä½³ç»“æœã€‚
  - `enrich_paper(paper) â†’ PaperItem`: **DOI â†’ æ ‡é¢˜ â†’ URL** é¡ºåºæŸ¥æ‰¾ã€‚CrossRef **è¦†ç›–**å¯ç”¨å­—æ®µã€‚é¢å¤–å…ƒæ•°æ®å­˜å…¥ `extra["crossref"]`ï¼›æœªåŒ¹é…æ—¶å†™å…¥ `extra["crossref_unmatched"]`ï¼ˆdoi/title/urlï¼‰ã€‚
  - `close()`: å…³é—­ httpx AsyncClientã€‚
- **Polite Pool**: é€šè¿‡ `User-Agent` å’Œ `mailto` å¤´éƒ¨è·å–æ›´é«˜é€Ÿç‡é™åˆ¶ã€‚

### 5.7 OpenAlexClient (`sources/openalex.py`)

- **ç”¨é€”**: OpenAlex REST API å®¢æˆ·ç«¯ï¼Œç”¨äºå¼€æ”¾å…ƒæ•°æ®è¡¥å……ã€‚
- **æ ¸å¿ƒç±»**: `OpenAlexWork`ï¼ˆdataclassï¼‰â€” åŒ…å« doi, title, authorsï¼ˆdisplay nameï¼‰, journal, cited_by_count, concepts ç­‰ 14 ä¸ªå­—æ®µã€‚
- **æ–¹æ³•**:
  - `search_by_title(title, per_page=5)`: æŒ‰æ ‡é¢˜æœç´¢ã€‚
  - `get_by_doi(doi)`: æŒ‰ DOI ç²¾ç¡®æŸ¥æ‰¾ã€‚
  - `find_best_match(title, threshold=0.8)`: åŒ CrossRef çš„ Jaccard ç›¸ä¼¼åº¦ã€‚
  - `enrich_paper(paper) â†’ PaperItem`: **DOI â†’ æ ‡é¢˜ â†’ URL** é¡ºåºæŸ¥æ‰¾ã€‚**åªè¡¥å……ç¼ºå¤±å­—æ®µ**ã€‚é¢å¤–å…ƒæ•°æ®å­˜å…¥ `extra["openalex"]`ï¼›æœªåŒ¹é…æ—¶å†™å…¥ `extra["openalex_unmatched"]`ï¼ˆdoi/title/urlï¼‰ã€‚
  - `_reconstruct_abstract(inverted_index)`: ä» OpenAlex å€’æ’ç´¢å¼• `{word: [positions]}` é‡å»ºè¿ç»­æ–‡æœ¬ã€‚
  - `close()`: å…³é—­ httpx AsyncClientã€‚

---

## 7. è¿‡æ»¤ç³»ç»Ÿ

### ä¸¤çº§ç­›é€‰è®¾è®¡

```
200 papers (RSS åŸå§‹æŠ“å–)
    â”‚
    â–¼  Stage 1: KeywordFilterStage (OR é€»è¾‘, å®½è¿›)
   12 papers
    â”‚
    â–¼  Stage 2: AIFilterStage (LLM è¯­ä¹‰ç²¾é€‰, ä¸¥å‡º)
    1 paper
```

- **ä¸€çº§ï¼ˆå…³é”®è¯ ORï¼‰**: å¿«é€Ÿã€ä½æˆæœ¬çš„å®½ç­›é€‰ã€‚è‹¥æœªä¼  `--keywords`ï¼Œä¼šæ ¹æ® `RESEARCH_PROMPT` è‡ªåŠ¨ç”Ÿæˆå…³é”®è¯ã€‚
- **äºŒçº§ï¼ˆAI ç²¾é€‰ï¼‰**: ä½¿ç”¨ LLM æ ¹æ®ç ”ç©¶å…´è¶£ prompt åˆ¤æ–­è¯­ä¹‰ç›¸å…³æ€§ï¼Œç²¾ç¡®è¿‡æ»¤ã€‚

è¿™ç§è®¾è®¡ç¡®ä¿ï¼šå…³é”®è¯é˜¶æ®µä¸ä¼šè¯¯æ€ç›¸å…³è®ºæ–‡ï¼ˆå®½è¿›ï¼‰ï¼ŒAI é˜¶æ®µè´Ÿè´£ç²¾ç¡®åˆ¤æ–­ï¼ˆä¸¥å‡ºï¼‰ã€‚

### FilterPipeline (`filters/pipeline.py`)

é¡ºåºé˜¶æ®µç¼–æ’å™¨ã€‚æ„é€ å‡½æ•°: `FilterPipeline(llm_client=None)`

```python
# llm_client ä¸º None æ—¶åªæœ‰å…³é”®è¯é˜¶æ®µ
pipeline = FilterPipeline()

# ä¼ å…¥ OpenAI client æ—¶å¯ç”¨ AI é˜¶æ®µï¼ˆæ¡ä»¶å¯¼å…¥ AIFilterStageï¼‰
pipeline = FilterPipeline(llm_client=OpenAI(api_key=..., base_url=...))
```

ä¸¤ä¸ªé˜¶æ®µæŒ‰é¡ºåºæ‰§è¡Œï¼Œæ¯é˜¶æ®µé€šè¿‡ `is_applicable(criteria)` åˆ¤æ–­æ˜¯å¦è¿è¡Œï¼š
- **Stage 1**: `KeywordFilterStage` â€” å½“ keywords/exclude_keywords/authors/min_date/has_pdf ä»»ä¸€éé»˜è®¤å€¼æ—¶è¿è¡Œ
- **Stage 2**: `AIFilterStage` â€” å½“ `llm_client` å·²æä¾›ä¸” `_client is not None` æ—¶è¿è¡Œã€‚é€šè¿‡ `try/except ImportError` æ¡ä»¶å¯¼å…¥ï¼Œæ¨¡å—ä¸å¯ç”¨æ—¶è·³è¿‡å¹¶è­¦å‘Š

### KeywordFilterStage (`filters/keyword.py`)

æŒ‰é¡ºåºåº”ç”¨è¿‡æ»¤å™¨ï¼ˆé¦–æ¬¡å¤±è´¥å³æå‰é€€å‡ºï¼‰ï¼š
1. **æ’é™¤å…³é”®è¯**ï¼ˆOR â€” ä»»ä¸€åŒ¹é…åˆ™æ’é™¤ï¼‰åœ¨æ ‡é¢˜+æ‘˜è¦ä¸­
2. **å…³é”®è¯**ï¼ˆOR â€” ä»»ä¸€åŒ¹é…å³é€šè¿‡ï¼‰åœ¨æ ‡é¢˜+æ‘˜è¦ä¸­ï¼Œä½œä¸ºä¸€çº§å®½ç­›é€‰
3. **ä½œè€…**ï¼ˆOR â€” ä»»ä¸€åŒ¹é…ï¼‰å¯¹ç…§ `paper.authors`
4. **PDF å¯ç”¨æ€§** â€” è¦æ±‚ `pdf_url is not None`
5. **æœ€æ—©æ—¥æœŸ** â€” è¦æ±‚ `published_date >= min_date`ï¼ˆæ— æ—¥æœŸçš„è®ºæ–‡é€šè¿‡ï¼‰

æ‰€æœ‰å­—ç¬¦ä¸²åŒ¹é…ä¸åŒºåˆ†å¤§å°å†™ï¼ŒåŸºäºå­å­—ç¬¦ä¸²ã€‚

---

## 8. AI æ¨¡å— (`ai/`)

AI æ¨¡å—ä½¿ç”¨ OpenAI å…¼å®¹ API æä¾›é«˜çº§è¿‡æ»¤å’Œå…³é”®è¯ç”Ÿæˆèƒ½åŠ›ã€‚

### 7.1 KeywordGenerator (`ai/keyword_generator.py`)

ä»è‡ªç„¶è¯­è¨€æç¤ºä¸­æå–ç ”ç©¶å…³é”®è¯å¹¶ä¸è®ºæ–‡åŒ¹é…ã€‚
- **æå–**: ä¸¤é˜¶æ®µç®¡é“ï¼ˆç”Ÿæˆå€™é€‰è¯ â†’ é€‰æ‹©æœ€ä½³ 10 ä¸ªï¼‰ã€‚
- **åŒ¹é…**: 5 ç­–ç•¥çµæ´»åŒ¹é…ï¼š
  1. ç²¾ç¡®å­å­—ç¬¦ä¸²ï¼ˆæ ‡å‡†åŒ–ï¼‰
  2. å…¨è¯åŒ¹é…ï¼ˆå…³é”®è¯çš„æ‰€æœ‰å•è¯éƒ½å‡ºç°åœ¨æ–‡æœ¬ä¸­ï¼‰
  3. è¯å¹²åŒ¹é…ï¼ˆç®€å•åç¼€å»é™¤ï¼‰
  4. åŒ–å­¦åŒä¹‰è¯åŒ¹é…ï¼ˆå¦‚ "Zinc" <-> "Zn"ï¼‰
  5. æ ¸å¿ƒæœ¯è¯­åŒ¹é…ï¼ˆå¦‚ "operando", "in-situ"ï¼‰
- **ç¼“å­˜**: ç»“æœåŸºäºæç¤ºå“ˆå¸Œç¼“å­˜åœ¨ `cache/keywords_cache.json` ä¸­ã€‚

### 7.2 AIFilterStage (`filters/ai_filter.py`)

LLM é©±åŠ¨çš„è¯­ä¹‰ç›¸å…³æ€§åˆ¤æ–­ã€‚æ„é€ å‡½æ•°: `AIFilterStage(openai_client=None, model=None)`

- **æ‰¹å¤„ç†**: æŒ‰æ‰¹æ¬¡å¤„ç†è®ºæ–‡ï¼ˆé»˜è®¤: 50 ç¯‡ï¼Œ`AI_BATCH_SIZE` å¯é…ï¼‰ï¼Œæ¯æ‰¹ä¸€æ¬¡ API è°ƒç”¨ã€‚
- **æç¤ºè¯­è¨€**: **ä¸­æ–‡**ã€‚System prompt: "ä½ æ˜¯ä¸€ä¸ªå­¦æœ¯è®ºæ–‡ç›¸å…³æ€§åˆ¤æ–­åŠ©æ‰‹"ã€‚User prompt åŒ…å« `RESEARCH_PROMPT` + ç¼–å·è®ºæ–‡åˆ—è¡¨ï¼ˆæ‘˜è¦æˆªæ–­è‡³ 500 å­—ç¬¦ï¼‰ã€‚
- **LLM å‚æ•°**: `temperature=0.0`, `max_tokens` ä» `AI_FILTER_MAX_TOKENS` è¯»å–ï¼ˆé»˜è®¤ 1000ï¼‰ã€‚
- **è¾“å‡ºæ ¼å¼**: æœŸæœ› JSON `{"relevant": [0, 3, 7, ...]}`ï¼ˆä» 0 å¼€å§‹çš„ç´¢å¼•ï¼‰ã€‚
- **é²æ£’è§£æ** (`_parse_filter_output`): 3 ç§ç­–ç•¥ä¾æ¬¡å°è¯•ï¼š
  1. ç›´æ¥ `json.loads()` è§£æ
  2. ä» markdown ä»£ç å— `` ```json {...}``` `` ä¸­æå–
  3. æ­£åˆ™æœç´¢è¾“å‡ºä¸­ä»»æ„ä½ç½®çš„ `{"relevant": [...]}` å¯¹è±¡
- **ç´¢å¼•éªŒè¯**: `_validate_indices()` è¿‡æ»¤è¶Šç•Œå’Œéæ•´æ•°å€¼ã€‚
- **å¤±è´¥å¼€æ”¾**: API è°ƒç”¨å¼‚å¸¸æ—¶ï¼Œ**è¿”å›è¯¥æ‰¹æ¬¡æ‰€æœ‰è®ºæ–‡**ï¼ˆè§†ä¸ºå…¨éƒ¨ç›¸å…³ï¼‰ï¼Œç¡®ä¿ä¸å› æŠ€æœ¯é”™è¯¯ä¸¢å¤±è®ºæ–‡ã€‚è§£æå¤±è´¥æ—¶è¿”å›ç©ºé›†ï¼ˆè¯¥æ‰¹æ¬¡å…¨éƒ¨æ’é™¤ï¼‰ã€‚
- **å‰ç½®æ¡ä»¶**: æ—  `OPENAI_API_KEY` æˆ–æ—  `RESEARCH_PROMPT` æ—¶è·³è¿‡ï¼Œè¿”å›åŸå§‹åˆ—è¡¨ã€‚

---

## 9. é…ç½®ç³»ç»Ÿ (`config/settings.py`)

ä½¿ç”¨ `python-dotenv` çš„é›†ä¸­å¼é…ç½®ç®¡ç†ã€‚

- **Dotenv é›†æˆ**: é€šè¿‡ `_ensure_dotenv()` ä»é¡¹ç›®æ ¹ç›®å½•æˆ– CWD å»¶è¿ŸåŠ è½½ `.env` æ–‡ä»¶ã€‚ä½¿ç”¨ `override=True` ç¡®ä¿ `.env` å€¼ä¼˜å…ˆäºç³»ç»Ÿç¯å¢ƒå˜é‡ã€‚
- **ç±»å‹åŒ–è®¿é—®å™¨**:
  - `get_openai_config()`: API å¯†é’¥ã€æ¨¡å‹ã€åŸºç¡€ URLã€‚
  - `get_gmail_config()`: Token JSON / å‡­è¯ JSONï¼ˆå†…è”ï¼Œå¿…å¡«ï¼‰ã€æœç´¢æŸ¥è¯¢ã€å‘ä»¶äººè¿‡æ»¤ã€‚
  - `get_zotero_config()`: åº“ IDã€API å¯†é’¥ã€ç±»å‹ã€‚
  - `get_rss_config()`: OPML è·¯å¾„ã€User-Agentã€è¶…æ—¶ã€æœ€å¤§å¹¶å‘ã€‚
  - `get_crossref_config()` / `get_openalex_config()`: é€šè¿‡ `_get_shared_api_defaults()` å…±äº« `POLITE_POOL_EMAIL`ã€`API_TIMEOUT`ã€`API_USER_AGENT`ï¼Œæ”¯æŒæ¯æœåŠ¡è¦†ç›–ã€‚
  - `get_research_prompt()`: è‡ªç„¶è¯­è¨€ç ”ç©¶å…´è¶£ï¼ˆä»ç¯å¢ƒå˜é‡æˆ–æ–‡ä»¶è·å–ï¼‰ã€‚
  - `get_ai_filter_config()`: AI æ‰¹æ¬¡å¤§å°ã€æœ€å¤§ tokenã€‚
  - `get_keyword_generator_config()`: å…³é”®è¯ç”Ÿæˆ/é€‰æ‹©æœ€å¤§ tokenã€‚

### å…³é”®ç¯å¢ƒå˜é‡è¯´æ˜

**å¿…éœ€é…ç½®**ï¼ˆæ ¹æ®åŠŸèƒ½ï¼‰:
```bash
# AI è¿‡æ»¤ï¼ˆé»˜è®¤å¯ç”¨ï¼›ä½¿ç”¨ `--no-ai` å¯å…³é—­ï¼‰
OPENAI_API_KEY=your-api-key-here
OPENAI_BASE_URL=https://api.deepseek.com/v1  # å¯é€‰ï¼Œä½¿ç”¨ DeepSeek
RESEARCH_PROMPT="æˆ‘çš„ç ”ç©¶å…´è¶£æ˜¯..."  # AI è¿‡æ»¤çš„åˆ¤æ–­ä¾æ®

# Gmail æºï¼ˆä½¿ç”¨ --source gmail æ—¶å¿…éœ€ï¼ŒäºŒé€‰ä¸€ï¼‰
# æ–¹å¼ A: ç›´æ¥æä¾›æ–‡ä»¶ï¼ˆé»˜è®¤è·¯å¾„ï¼‰
# feeds/token.json
# feeds/credentials.json
# æ–¹å¼ B: å†…è” JSONï¼ˆå¯åŠ¨æ—¶å†™å…¥ feeds/ ç›®å½•ï¼‰
# GMAIL_TOKEN_JSON='{"token": "...", "refresh_token": "...", ...}'
# GMAIL_CREDENTIALS_JSON='{"installed": {"client_id": "...", ...}}'
# GMAIL_TOKEN_FILE=feeds/token.json
# GMAIL_CREDENTIALS_FILE=feeds/credentials.json
```

**æ¨èé…ç½®**:
```bash
# å…ƒæ•°æ®è¡¥å……ä¼˜åŒ–
POLITE_POOL_EMAIL=your@email.com  # CrossRef/OpenAlex é«˜é€Ÿè®¿é—®

# RSS æºé…ç½®
PAPER_FEEDDER_MCP_OPML=feeds/RSS_official.opml  # é»˜è®¤ OPML æ–‡ä»¶è·¯å¾„
PAPER_FEEDDER_MCP_USER_AGENT=paper-feedder-mcp/2.0  # ç»Ÿä¸€ User-Agent
RSS_MAX_CONCURRENT=10  # å¹¶å‘æŠ“å–æ•°é‡
```

**å¯é€‰é…ç½®**:
```bash
# OpenAI æ¨¡å‹é…ç½®
OPENAI_MODEL=deepseek-chat  # é»˜è®¤æ¨¡å‹

# AI è¿‡æ»¤å‚æ•°
AI_BATCH_SIZE=50  # æ¯æ‰¹å¤„ç†è®ºæ–‡æ•°
AI_FILTER_MAX_TOKENS=1000  # AI è¿‡æ»¤å“åº” token é™åˆ¶

# Gmail å¤„ç†è¡Œä¸º
GMAIL_TRASH_AFTER_PROCESS=true  # å¤„ç†æˆåŠŸåç§»å…¥å›æ”¶ç«™
GMAIL_VERIFY_TRASH_AFTER_PROCESS=true  # å¤„ç†åæ‰§è¡Œ Trash æ ¸å¯¹
GMAIL_VERIFY_TRASH_LIMIT=50  # Trash æ ¸å¯¹æœ€å¤§çº¿ç¨‹æ•°
GMAIL_SENDER_FILTER=scholaralerts-noreply@google.com,noreply@nature.com  # å‘ä»¶äººç­›é€‰åˆ—è¡¨
GMAIL_SENDER_MAP_JSON='{"scholaralerts-noreply@google.com":"Google Scholar","noreply@nature.com":"Nature"}'

# API è¶…æ—¶
API_TIMEOUT=30  # ç§’

# OpenAlex é™æµï¼ˆå»ºè®®é…ç½®ï¼‰
OPENALEX_API_KEY=your-openalex-key  # OpenAlex API éœ€è¦ keyï¼ˆå…è´¹ï¼‰
OPENALEX_MAX_REQUESTS_PER_SECOND=10
```

### Gmail OAuth2 é…ç½®è¯¦è§£

æ”¯æŒä¸¤ç§æ–¹å¼ï¼ˆäºŒé€‰ä¸€ï¼‰ï¼š
- **æ–‡ä»¶æ¨¡å¼ï¼ˆæ¨èï¼‰**ï¼šå°† `token.json` ä¸ `credentials.json` æ”¾åœ¨ `feeds/` ç›®å½•
- **å†…è” JSON æ¨¡å¼**ï¼šè®¾ç½® `GMAIL_TOKEN_JSON` ä¸ `GMAIL_CREDENTIALS_JSON`ï¼Œç¨‹åºå¯åŠ¨æ—¶å†™å…¥ `feeds/`

**è·å–æ­¥éª¤**:
1. åœ¨ Google Cloud Console åˆ›å»º OAuth2 å‡­æ®
2. ä¸‹è½½ `credentials.json` å¹¶æ”¾åˆ° `feeds/credentials.json`
3. è¿è¡Œ ezgmail åˆå§‹åŒ–ç”Ÿæˆ `token.json`ï¼Œæ”¾åˆ° `feeds/token.json`
4. æˆ–å°†ä¸¤ä¸ª JSON å†…å®¹å†™å…¥ `.env`ï¼ˆå†…è” JSON æ¨¡å¼ï¼‰

**æ³¨æ„**: æ–‡ä»¶è·¯å¾„å¯é€šè¿‡ `GMAIL_TOKEN_FILE` / `GMAIL_CREDENTIALS_FILE` è¦†ç›–ï¼Œé»˜è®¤ä½¿ç”¨ `feeds/` ç›®å½•ã€‚

### å…±äº« API é…ç½®

CrossRef å’Œ OpenAlex å…±äº«ä»¥ä¸‹é»˜è®¤å€¼ï¼Œé¿å…é‡å¤é…ç½®ï¼š
- `POLITE_POOL_EMAIL` â†’ å…±äº«é‚®ç®±ï¼ˆå¼ºçƒˆæ¨èé…ç½®ï¼‰
- `API_TIMEOUT` â†’ å…±äº«è¶…æ—¶
- `API_USER_AGENT` â†’ å…±äº« User-Agent

æ¯ä¸ªæœåŠ¡å¯é€šè¿‡ `CROSSREF_*` / `OPENALEX_*` å‰ç¼€çš„ç¯å¢ƒå˜é‡è¦†ç›–å…±äº«å€¼ã€‚

---

## 10. å‘½ä»¤è¡Œæ¥å£ (`client/cli.py`)

`paper-feedder-mcp` CLI ä¸ºæ‰€æœ‰æ¡†æ¶æ“ä½œæä¾›ç»Ÿä¸€æ¥å£ã€‚

### å­å‘½ä»¤

- **`fetch`**: ä»æ•°æ®æºæ”¶é›†è®ºæ–‡ã€‚
  - `--source`: `rss`ï¼ˆé»˜è®¤ï¼‰æˆ– `gmail`ã€‚
  - `--output`: è¾“å‡º JSON æ–‡ä»¶è·¯å¾„ï¼ˆå¿…å¡«ï¼‰ã€‚
  - `--opml`: OPML æ–‡ä»¶è·¯å¾„ï¼ˆç”¨äº RSSï¼‰ã€‚
  - `--query`: Gmail æœç´¢æŸ¥è¯¢ã€‚
  - `--limit` / `--since`: æŠ“å–çº¦æŸï¼ˆ`--since` é»˜è®¤è¿‘ 15 å¤©ï¼‰ã€‚
- **`filter`**: åº”ç”¨è¿‡æ»¤ç®¡é“ã€‚
  - `--input` / `--output`: JSON æ–‡ä»¶è·¯å¾„ã€‚
  - `--keywords`: å…³é”®è¯è¿‡æ»¤ï¼ˆOR é€»è¾‘ï¼Œä¸€çº§å®½ç­›é€‰ï¼‰ã€‚
  - `--authors` / `--exclude`: ä½œè€…/æ’é™¤å…³é”®è¯è¿‡æ»¤ã€‚
  - `--min-date` / `--has-pdf`: å…ƒæ•°æ®è¿‡æ»¤ã€‚
  - `--ai` / `--no-ai`: å¯ç”¨æˆ–ç¦ç”¨ LLM è¯­ä¹‰è¿‡æ»¤ï¼ˆé»˜è®¤å¯ç”¨ï¼‰ã€‚
- **`enrich`**: é€šè¿‡å¤–éƒ¨ API è¿›è¡Œå…ƒæ•°æ®è¡¥å……ã€‚
  - `--api` / `--source` / `--provider`: `crossref`ã€`openalex` æˆ– `all`ï¼ˆé»˜è®¤ï¼‰ã€‚
  - `--jobs` / `--concurrency` / `--parallel`: æœ€å¤§å¹¶è¡Œ API è¯·æ±‚æ•°ï¼ˆé»˜è®¤: 5ï¼Œé€šè¿‡ `asyncio.Semaphore` æ§åˆ¶ï¼‰ã€‚
  - **æ‰§è¡Œé€»è¾‘**ï¼ˆ`--api all` æ—¶ï¼‰: CrossRef ä¸ OpenAlex ä¾æ¬¡æ‰§è¡Œï¼ˆå‡ä¼šå°è¯•è¡¥å……ç¼ºå¤±å­—æ®µï¼‰ã€‚æ¯ä¸ª client åœ¨ `finally` ä¸­è°ƒç”¨ `close()` é‡Šæ”¾è¿æ¥ã€‚
- **`export`**: å¯¼å‡ºè®ºæ–‡åˆ°ç›®æ ‡æ ¼å¼ã€‚
  - `--format`: `json`ï¼ˆé»˜è®¤ï¼‰æˆ– `zotero`ã€‚
  - `--include-metadata` / `--no-metadata`: æ˜¯å¦åŒ…å«æ‰©å±•å­—æ®µï¼ˆ`extra`ï¼Œé»˜è®¤åŒ…å«ï¼‰ã€‚
- **`delete`**: åˆ é™¤ `output/` ç›®å½•åŠå¸¸è§ä¸­é—´æ–‡ä»¶ï¼ˆå¦‚ `raw.json`ã€`filtered.json`ã€`enriched.json` ç­‰ï¼‰ã€‚

### ä½¿ç”¨ç¤ºä¾‹

```bash
# å®Œæ•´ Pipeline ç¤ºä¾‹
# 1. ä» RSS è·å–è®ºæ–‡
uv run paper-feedder-mcp fetch --source rss --limit 50 --output output/raw.json

# 2. å…³é”®è¯è¿‡æ»¤
uv run paper-feedder-mcp filter --input output/raw.json --output output/filtered.json \
    --keywords battery energy lithium

# 3. AI è¯­ä¹‰è¿‡æ»¤ï¼ˆéœ€é…ç½® OPENAI_API_KEYï¼‰
uv run paper-feedder-mcp filter --input output/filtered.json --output output/ai_filtered.json \
    --keywords battery

# 4. å…ƒæ•°æ®è¡¥å……
uv run paper-feedder-mcp enrich --input output/ai_filtered.json --output output/enriched.json \
    --api all --concurrency 5

# 5. å¯¼å‡º
uv run paper-feedder-mcp export --input output/enriched.json --output output/final.json \
    --format json

# 6. æ¸…ç†è¾“å‡ºï¼ˆå¯é€‰ï¼‰
uv run paper-feedder-mcp delete
```

---

## 11. é€‚é…å™¨ç³»ç»Ÿ

### JSONAdapter (`adapters/json.py`)

- `export(papers, filepath="output/papers.json", include_metadata=True) â†’ Dict`ï¼ˆé»˜è®¤ `include_metadata=True`ï¼‰
- å°† `List[PaperItem]` å¯¼å‡ºä¸º JSON æ–‡ä»¶ï¼ˆ`model_dump()` åºåˆ—åŒ–ï¼‰
- å°† `date` å¯¹è±¡è½¬æ¢ä¸º ISO æ ¼å¼å­—ç¬¦ä¸²
- `include_metadata=False` æ—¶ç§»é™¤ `extra` å­—æ®µ
- è‡ªåŠ¨åˆ›å»ºçˆ¶ç›®å½•ï¼ˆ`Path.mkdir(parents=True)`ï¼‰
- UTF-8 ç¼–ç ï¼Œç¾åŒ–è¾“å‡ºï¼ˆ`indent=2, ensure_ascii=False`ï¼‰
- è¿”å› `{"count": int, "filepath": str, "success": bool}`

### ZoteroAdapter (`adapters/zotero.py`)

- é€šè¿‡æœ¬åœ° `zotero-mcp` ä»“åº“å¯¼å‡ºåˆ° Zotero åº“
- é»˜è®¤è·¯å¾„ï¼š`E:\Desktop\SciPapers\zotero-mcp\src`ï¼Œæˆ–è®¾ç½® `ZOTERO_MCP_PATH`
- å°† PaperItem è½¬æ¢ä¸º Zotero `journalArticle` æ ¼å¼
- æ‰¹å¤„ç†ï¼Œæ¯é¡¹é”™è¯¯å•ç‹¬å¤„ç†

---

## 12. å·¥å…·å‡½æ•° (`utils/text.py`)

- `clean_title(title)` â€” å»é™¤ `[DOI]`ã€`[PDF]` ç­‰å‰ç¼€
- `clean_html(raw_html)` â€” å»é™¤ HTML æ ‡ç­¾
- `clean_abstract(abstract)` â€” å®Œæ•´æ‘˜è¦æ¸…ç†: HTML å®ä½“ã€XML/JATS æ ‡ç­¾ã€åµŒå…¥çš„ DOI/URLã€ç©ºç™½æ ‡å‡†åŒ–
- `DOI_PATTERN` â€” ç¼–è¯‘çš„æ­£åˆ™è¡¨è¾¾å¼: `r"10\.\d{4,9}/[-._;()/:A-Z0-9]+"` ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰

---

## 13. ä¾èµ–

### å¿…é€‰ä¾èµ–
| åŒ… | ç”¨é€” |
|---|------|
| `feedparser>=6.0.0` | RSS/Atom è®¢é˜…æºè§£æ |
| `pydantic>=2.0.0` | å¸¦éªŒè¯çš„æ•°æ®æ¨¡å‹ |
| `httpx>=0.25.0` | å¼‚æ­¥ HTTP å®¢æˆ·ç«¯ |
| `python-dateutil>=2.8.0` | æ—¥æœŸè§£æ |
| `beautifulsoup4>=4.12.0` | HTML è§£æï¼ˆGmail é‚®ä»¶ï¼‰ |
| `ezgmail>=0.1.0` | Gmail API è®¿é—® |
| `openai>=1.0.0` | AI é©±åŠ¨çš„è¿‡æ»¤ä¸å…³é”®è¯ç”Ÿæˆ |
| `python-dotenv>=1.0.0` | ç¯å¢ƒå˜é‡ç®¡ç† |

### å¯é€‰ä¾èµ–
| åŒ… | Extra | ç”¨é€” |
|---|-------|------|
| `zotero-mcp` | æœ¬åœ°ä»“åº“ | Zotero API å¯¼å‡º |

### å¼€å‘ä¾èµ–
| åŒ… | ç”¨é€” |
|---|------|
| `pytest>=7.0.0` | æµ‹è¯• |
| `pytest-asyncio>=0.21.0` | å¼‚æ­¥æµ‹è¯•æ”¯æŒ |
| `ruff>=0.1.0` | ä»£ç æ£€æŸ¥ + æ ¼å¼åŒ– |
| `ty` | ç±»å‹æ£€æŸ¥ï¼ˆRed Knotï¼‰ |

---

## 14. è®¾è®¡æ¨¡å¼

| æ¨¡å¼ | ä½ç½® | ç”¨é€” |
|------|------|------|
| **æŠ½è±¡å·¥å‚** | `PaperSource`, `ExportAdapter` | é€šè¿‡ç»Ÿä¸€æ¥å£å®ç°å¯äº’æ¢çš„æ•°æ®æº/é€‚é…å™¨ |
| **ç®¡é“** | `FilterPipeline` | é¡ºåºé˜¶æ®µå¤„ç† |
| **ç­–ç•¥** | Adapters | è¿è¡Œæ—¶é€‰æ‹©å¯¼å‡ºç­–ç•¥ |
| **å¯é€‰ä¾èµ–** | `__init__.py`, `adapters/__init__.py`, `sources/__init__.py` | é€šè¿‡ `try/except ImportError` ä¼˜é›…å¯¼å…¥ |
| **å…³æ³¨ç‚¹åˆ†ç¦»** | æ¨¡å—ç»“æ„ | æ•°æ®æºæŠ“å–ã€è¿‡æ»¤å™¨è¿‡æ»¤ã€é€‚é…å™¨å¯¼å‡º |
| **å¼‚æ­¥ä¼˜å…ˆ** | æ‰€æœ‰å…¬å…± API | é€šè¿‡ `async/await` å®ç°éé˜»å¡ I/O |
| **é…ç½®** | `config/settings.py` | åŸºäº dotenv çš„é›†ä¸­é…ç½® |
| **å…ƒæ•°æ®è¡¥å……** | `sources/crossref.py`, `sources/openalex.py` | è¿‡æ»¤åé€šè¿‡å¤–éƒ¨ API è¡¥å……å…ƒæ•°æ® |
| **å¤±è´¥å¼€æ”¾** | `filters/ai_filter.py` | AI è¿‡æ»¤å‡ºé”™æ—¶è¿”å›æ‰€æœ‰è®ºæ–‡ |

---

## 15. ç¼–ç è§„èŒƒ

### é£æ ¼
- **è¡Œå®½**: 88 å­—ç¬¦ï¼ˆruffï¼‰
- **ç›®æ ‡ Python**: 3.12+
- **å¯¼å…¥é¡ºåº**: æ ‡å‡†åº“ â†’ ç¬¬ä¸‰æ–¹ â†’ æœ¬åœ°ï¼ˆç©ºè¡Œåˆ†éš”ï¼‰
- **æ–‡æ¡£å­—ç¬¦ä¸²**: Google é£æ ¼ï¼ŒåŒ…å« Args/Returns/Raises æ®µè½
- **ç±»å‹æ³¨è§£**: æ‰€æœ‰åœ°æ–¹ã€‚å…è®¸ä½¿ç”¨ `T | None`ï¼ˆPython 3.12ï¼‰
- **æ—¥å¿—**: æ¯ä¸ªæ¨¡å—ä½¿ç”¨ `logging.getLogger(__name__)`

### ä»£ç æ¨¡å¼
- **å¼‚æ­¥åŒ…è£…**: å¯¹é˜»å¡è°ƒç”¨ä½¿ç”¨ `asyncio.to_thread()`ï¼ˆfeedparser, ezgmailï¼‰
- **é”™è¯¯å¤„ç†**: è®°å½•æ—¥å¿— + è·³è¿‡æ— æ•ˆé¡¹ï¼›ä¸å› å•ä¸ªåæ¡ç›®å´©æºƒç®¡é“
- **å»é‡**: å§‹ç»ˆå¯¹ç»“æœå»é‡ï¼ˆRSS æŒ‰ URLï¼ŒGmail æŒ‰æ ‡é¢˜ï¼‰
- **å­—æ®µè®¿é—®**: ä½¿ç”¨ `_get_field(entry, key, default)` æ¨¡å¼å®‰å…¨è®¿é—®å­—å…¸/å¯¹è±¡
- **å¯é€‰ä¾èµ–**: åœ¨ `try/except ImportError` å—ä¸­å¯¼å…¥ï¼›è®¾ç½®æ¨¡å—çº§æ ‡å¿—

### åº”é¿å…çš„åæ¨¡å¼
- **ä¸è¦ä½¿ç”¨** `as any`ã€`@ts-ignore` ç­‰ä»·ç‰© â€” ä¸è¦æŠ‘åˆ¶ç±»å‹é”™è¯¯
- **ä¸è¦æ›´æ”¹ PaperItem schema** é™¤éç»å¯¹å¿…è¦ â€” ä½¿ç”¨ `extra` å­—å…¸æ›¿ä»£
- **ä¸è¦ç ´å ABC æ¥å£** â€” `PaperSource.fetch_papers()` å’Œ `ExportAdapter.export()` ç­¾åæ˜¯å¥‘çº¦
- **ä¸è¦ä¸ºå¯é€‰åŠŸèƒ½æ·»åŠ å¿…é€‰ä¾èµ–** â€” åœ¨ `pyproject.toml` ä¸­ä½¿ç”¨ optional extras

---

## 16. æµ‹è¯•è§„èŒƒ

- **æ¡†æ¶**: `pytest` + `pytest-asyncio`ï¼ˆæ¨¡å¼: `auto` â€” æ— éœ€ `@pytest.mark.asyncio` è£…é¥°å™¨ï¼‰
- **Mock**: `unittest.mock` â€” `MagicMock`, `AsyncMock`, `patch`
- **å¤–éƒ¨ä¾èµ–**: å§‹ç»ˆ mock HTTP è°ƒç”¨å’Œ ezgmailï¼›å•å…ƒæµ‹è¯•ä¸­ç»ä¸è®¿é—®çœŸå® API
- **é›†æˆæµ‹è¯•**: ç½‘ç»œè°ƒç”¨çš„é›†æˆæµ‹è¯•åœ¨ç¦»çº¿æ—¶è·³è¿‡ï¼ˆ`pytest.skip`ï¼‰
- **æµ‹è¯•ç»“æ„**: æ¯ä¸ªæºæ¨¡å—ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼ŒæŒ‰åŠŸèƒ½/ç­–ç•¥ç»„ç»‡
- **æ€»è®¡ï¼š346 é€šè¿‡ï¼Œ2 è·³è¿‡ï¼ˆZotero å¯é€‰ä¾èµ–ï¼‰ï¼Œ0 å¤±è´¥**

### è¿è¡Œæµ‹è¯•
```bash
# æ‰€æœ‰æµ‹è¯•
uv run pytest

# è¯¦ç»†è¾“å‡º
uv run pytest -v

# æŒ‡å®šæ–‡ä»¶
uv run pytest tests/unit/test_rss_source.py -v

# è¿è¡Œä»£ç æ£€æŸ¥
uv run ruff check

# è¿è¡Œç±»å‹æ£€æŸ¥
uv run ty check
```

---

## 17. ä¸å¯è¿åçš„çº¦æŸ

1. **ä¿ç•™æ¡†æ¶é€»è¾‘**: åˆ†å±‚æ¶æ„ï¼ˆcore â†’ sources/filters/adaptersï¼‰ä¸å¯æ›´æ”¹ã€‚
2. **ä¿ç•™ ABC æ¥å£**: `PaperSource.fetch_papers()` å’Œ `ExportAdapter.export()` ç­¾åæ˜¯å¥‘çº¦ã€‚
3. **ä¿ç•™ PaperItem schema**: ä½¿ç”¨ `extra` å­—å…¸è¿›è¡Œæ¥æºç‰¹å®šæ‰©å±•ï¼›ä¸è¦åœ¨æ²¡æœ‰å……åˆ†ç†ç”±çš„æƒ…å†µä¸‹æ·»åŠ æ–°çš„é¡¶å±‚å­—æ®µã€‚
4. **ä¸ç ´åç°æœ‰æµ‹è¯•**: æ‰€æœ‰ 350 ä¸ªæµ‹è¯•å¿…é¡»ç»§ç»­é€šè¿‡ã€‚
5. **å¯é€‰ä¾èµ–ä¿æŒå¯é€‰**: Gmailã€LLMã€Zotero åŠŸèƒ½å¿…é¡»åœ¨ `try/except ImportError` åé¢å·¥ä½œã€‚
6. **ä¿ç•™ `_extract_html_body` / `_find_html_in_payload`**: ezgmail ç¼ºå°‘ HTML æå– â€” è¿™äº›æ˜¯å¿…è¦çš„ã€‚
7. **å¼‚æ­¥ä¼˜å…ˆ**: æ–°çš„ I/O æ“ä½œå¿…é¡»æ˜¯å¼‚æ­¥çš„ï¼›ä½¿ç”¨ `asyncio.to_thread()` åŒ…è£…é˜»å¡è°ƒç”¨ã€‚
8. **ä¼˜é›…é™çº§**: ä¸å› å•ä¸ªåæ¡ç›®/é‚®ä»¶/è®¢é˜…æºå´©æºƒç®¡é“ã€‚
9. **ç§˜å¯†ä¿¡æ¯æ”¾ `.env`**: ç»ä¸åœ¨ä»£ç ä¸­ç¡¬ç¼–ç  API å¯†é’¥ã€Token æˆ–å‡­è¯ã€‚
10. **AI è¿‡æ»¤å¤±è´¥å¼€æ”¾**: AI è¿‡æ»¤å‡ºé”™æ—¶å¿…é¡»è¿”å›æ‰€æœ‰è®ºæ–‡ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚

---

## 18. æœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜

### æœ€ä½³å®è·µ

**1. Pipeline å·¥ä½œæµç¨‹**
```bash
# æ¨èï¼šæ¸è¿›å¼è¿‡æ»¤ï¼Œé¿å…ä¸€æ¬¡æ€§å¤„ç†å¤ªå¤šè®ºæ–‡
uv run paper-feedder-mcp fetch --source rss --limit 100 --output output/step1_raw.json
uv run paper-feedder-mcp filter --input output/step1_raw.json --output output/step2_keyword.json \
    --keywords "ä½ çš„å…³é”®è¯"
uv run paper-feedder-mcp filter --input output/step2_keyword.json --output output/step3_ai.json
uv run paper-feedder-mcp enrich --input output/step3_ai.json --output output/step4_enriched.json \
    --api all --concurrency 5
uv run paper-feedder-mcp export --input output/step4_enriched.json --output output/final.json
```

**2. å…³é”®è¯ç­–ç•¥**
- **ä¸€çº§è¿‡æ»¤**: ä½¿ç”¨å®½æ³›çš„å…³é”®è¯ï¼ˆ3-5ä¸ªï¼‰ï¼Œåˆ©ç”¨ OR é€»è¾‘æ•è·å°½å¯èƒ½å¤šçš„ç›¸å…³è®ºæ–‡
- **äºŒçº§è¿‡æ»¤**: é…ç½®è¯¦ç»†çš„ `RESEARCH_PROMPT`ï¼Œè®© AI è¿›è¡Œç²¾ç¡®åˆ¤æ–­
- **ç¤ºä¾‹**: å…³é”®è¯ç”¨ `battery zinc lithium`ï¼ŒRESEARCH_PROMPT è¯¦ç»†æè¿°ç ”ç©¶å…´è¶£

**3. API é…ç½®ä¼˜åŒ–**
- **CrossRef/OpenAlex**: é…ç½® `POLITE_POOL_EMAIL` è·å¾—æ›´é«˜é€Ÿç‡é™åˆ¶
- **å¹¶å‘æ§åˆ¶**: enrichment æ—¶ä½¿ç”¨ `--concurrency 3-5`ï¼Œé¿å…è§¦å‘é€Ÿç‡é™åˆ¶
- **AI è¿‡æ»¤**: ä½¿ç”¨ DeepSeek APIï¼ˆæ›´ä¾¿å®œï¼‰è€Œé OpenAI

**4. æ•°æ®ç®¡ç†**
- ä¸­é—´ JSON æ–‡ä»¶ä¾¿äºè°ƒè¯•å’Œé‡æ–°è¿‡æ»¤
- ç”¨å®Œå¯æ‰§è¡Œ `paper-feedder-mcp delete` ä¸€é”®æ¸…ç†è¾“å‡ºç›®å½•
- ä½¿ç”¨æœ‰æ„ä¹‰çš„æ–‡ä»¶åï¼ˆå¦‚ `2026-02-09_battery_papers.json`ï¼‰
- å®šæœŸå¤‡ä»½ `.env` æ–‡ä»¶ï¼ˆä½†ä¸è¦æäº¤åˆ° gitï¼‰

### å¸¸è§é—®é¢˜

**Q1: ä¸ºä»€ä¹ˆ AI è¿‡æ»¤æ²¡æœ‰ç”Ÿæ•ˆï¼Ÿ**
- æ£€æŸ¥ `OPENAI_API_KEY` æ˜¯å¦æ­£ç¡®è®¾ç½®
- æ£€æŸ¥ `RESEARCH_PROMPT` æ˜¯å¦å·²é…ç½®
- æŸ¥çœ‹æ—¥å¿—ä¸­æ˜¯å¦æœ‰ API é”™è¯¯ä¿¡æ¯

**Q2: Gmail æºæŠ¥é”™ "GMAIL_TOKEN_JSON not found"ï¼Ÿ**
- éœ€è¦å…ˆé€šè¿‡ Gmail OAuth2 è·å– token å’Œ credentials
- æ–¹å¼ Aï¼šæ”¾åˆ° `feeds/token.json` ä¸ `feeds/credentials.json`
- æ–¹å¼ Bï¼šå°† JSON å†…å®¹ä½œä¸ºå­—ç¬¦ä¸²è®¾ç½®åˆ° `.env`
- å‚è€ƒ `.env.example` ä¸­çš„æ ¼å¼

**Q3: Enrichment é€Ÿåº¦å¾ˆæ…¢ï¼Ÿ**
- CrossRef/OpenAlex API æœ‰é€Ÿç‡é™åˆ¶
- å‡å°‘å¹¶å‘æ•°ï¼ˆ`--concurrency 3`ï¼‰
- åªå¯¹éœ€è¦è¡¥å……çš„è®ºæ–‡è¿›è¡Œ enrichment

**Q4: è¿‡æ»¤ç»“æœå¤ªå°‘æˆ–å¤ªå¤šï¼Ÿ**
- **å¤ªå°‘**: æ”¾å®½å…³é”®è¯ï¼Œæ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº† `--exclude`
- **å¤ªå¤š**: æ·»åŠ æ›´å…·ä½“çš„å…³é”®è¯ï¼Œå¯ç”¨ AI è¿‡æ»¤

**Q5: å¦‚ä½•å¤„ç†ä¸­æ–‡è®ºæ–‡ï¼Ÿ**
- æ¡†æ¶æ”¯æŒ UTF-8ï¼Œå¯ä»¥å¤„ç†ä¸­æ–‡å†…å®¹
- AI è¿‡æ»¤çš„ prompt ä½¿ç”¨ä¸­æ–‡
- å…³é”®è¯å¯ä»¥ä½¿ç”¨ä¸­æ–‡æˆ–è‹±æ–‡

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

**RSS æºæŠ“å–**:
- è°ƒæ•´ `RSS_MAX_CONCURRENT`ï¼ˆé»˜è®¤ 10ï¼‰æ§åˆ¶å¹¶å‘æ•°
- ä½¿ç”¨ `--limit` é™åˆ¶è®ºæ–‡æ•°é‡
- ä½¿ç”¨ `--since` åªè·å–æœ€è¿‘çš„è®ºæ–‡

**è¿‡æ»¤æ€§èƒ½**:
- å…³é”®è¯è¿‡æ»¤éå¸¸å¿«ï¼ˆ~1000 ç¯‡/ç§’ï¼‰
- AI è¿‡æ»¤è¾ƒæ…¢ï¼ˆå— API é€Ÿç‡é™åˆ¶ï¼‰ï¼Œæ‰¹é‡å¤„ç† 50 ç¯‡/æ¬¡

**å†…å­˜ä½¿ç”¨**:
- æ¯ç¯‡è®ºæ–‡çº¦ 1-2KB å†…å­˜
- 10000 ç¯‡è®ºæ–‡çº¦éœ€ 10-20MB
- å¯ä»¥åˆ†æ‰¹å¤„ç†å¤§é‡è®ºæ–‡

---

## é™„å½• A: æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°çš„æ•°æ®æº
1. åˆ›å»º `sources/new_source.py`ï¼Œç±»ç»§æ‰¿ `PaperSource`
2. å®ç° `async def fetch_papers(self, limit, since) -> List[PaperItem]`
3. åœ¨ `sources/__init__.py` ä¸­æ·»åŠ å¯¼å‡ºï¼ˆå¦‚æœ‰å¯é€‰ä¾èµ–åˆ™ä½¿ç”¨ `try/except`ï¼‰
4. åœ¨ `__init__.py` ä¸­æ·»åŠ å…¬å…±å¯¼å‡º
5. åœ¨ `tests/unit/test_new_source.py` ä¸­æ·»åŠ æµ‹è¯•

### æ·»åŠ æ–°çš„è¿‡æ»¤é˜¶æ®µ
1. åˆ›å»ºé˜¶æ®µç±»ï¼ŒåŒ…å« `async def filter(papers, criteria) -> Tuple[List[PaperItem], List[str]]`
2. æ·»åŠ  `is_applicable(criteria) -> bool` æ–¹æ³•
3. åœ¨ `FilterPipeline.__init__` å’Œ `FilterPipeline.filter()` ä¸­æ³¨å†Œ

### æ·»åŠ æ–°çš„é€‚é…å™¨
1. åˆ›å»º `adapters/new_adapter.py`ï¼Œç»§æ‰¿ `ExportAdapter`
2. å®ç° `async def export(self, papers, **kwargs)`
3. åœ¨ `adapters/__init__.py` ä¸­æ·»åŠ å¯¼å‡º
4. åœ¨ `__init__.py` ä¸­æ·»åŠ å…¬å…±å¯¼å‡º
5. æ·»åŠ æµ‹è¯•

---

## é™„å½• B: æ•…éšœæ’é™¤

### å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ

**1. `ModuleNotFoundError: No module named 'src'`**
```bash
# è§£å†³ï¼šç¡®ä¿ä½¿ç”¨ uv run
uv sync  # å…ˆåŒæ­¥ä¾èµ–
uv run paper-feedder-mcp --help
```

**2. `FileNotFoundError: .env file not found`**
```bash
# è§£å†³ï¼šåˆ›å»º .env æ–‡ä»¶
cp .env.example .env
# ç„¶åç¼–è¾‘ .env å¡«å…¥ä½ çš„é…ç½®
```

**3. `HTTPError: 429 Too Many Requests`ï¼ˆCrossRef/OpenAlexï¼‰**
```bash
# è§£å†³ï¼š
# 1. å‡å°‘å¹¶å‘æ•°
uv run paper-feedder-mcp enrich --concurrency 2 ...
# 2. é…ç½® POLITE_POOL_EMAIL è·å¾—æ›´é«˜é™åˆ¶
echo "POLITE_POOL_EMAIL=your@email.com" >> .env
# 3. è®¾ç½® OpenAlex API Key å¹¶é™ä½è¯·æ±‚é€Ÿç‡
echo "OPENALEX_API_KEY=your-openalex-key" >> .env
echo "OPENALEX_MAX_REQUESTS_PER_SECOND=10" >> .env
```

**4. AI è¿‡æ»¤è¿”å›æ‰€æœ‰è®ºæ–‡ï¼ˆå¤±è´¥å¼€æ”¾ï¼‰**
```bash
# åŸå› ï¼šAPI è°ƒç”¨å¤±è´¥ï¼Œæ¡†æ¶è‡ªåŠ¨è¿”å›æ‰€æœ‰è®ºæ–‡é˜²æ­¢æ•°æ®ä¸¢å¤±
# è§£å†³ï¼š
# 1. æ£€æŸ¥ API key æ˜¯å¦æ­£ç¡®
# 2. æ£€æŸ¥ç½‘ç»œè¿æ¥
# 3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼šuv run paper-feedder-mcp filter ... 2>&1 | tee log.txt
```

**5. `UnicodeDecodeError` æˆ–ä¹±ç **
```bash
# è§£å†³ï¼šç¡®ä¿æ‰€æœ‰æ–‡ä»¶ä½¿ç”¨ UTF-8 ç¼–ç 
# Windows ç”¨æˆ·ï¼šåœ¨ .env ä¸­æ·»åŠ 
echo "PYTHONIOENCODING=utf-8" >> .env
```

**6. Gmail æºæ— æ³•è®¿é—®**
```bash
# æ£€æŸ¥æ¸…å•ï¼š
# 1. feeds/token.json ä¸ feeds/credentials.json å·²å­˜åœ¨ï¼Œæˆ–
#    GMAIL_TOKEN_JSON ä¸ GMAIL_CREDENTIALS_JSON å·²è®¾ç½®
# 2. JSON æ ¼å¼æ­£ç¡®ï¼ˆä½¿ç”¨å•å¼•å·åŒ…è£¹æ•´ä¸ª JSON å­—ç¬¦ä¸²ï¼‰
# 3. Gmail API å·²åœ¨ Google Cloud Console ä¸­å¯ç”¨
# 4. OAuth2 consent screen å·²é…ç½®
```

### è°ƒè¯•æŠ€å·§

**å¯ç”¨è¯¦ç»†æ—¥å¿—**:
```bash
# Python logging çº§åˆ«
export LOG_LEVEL=DEBUG
uv run paper-feedder-mcp fetch ...
```

**æ£€æŸ¥ä¸­é—´è¾“å‡º**:
```bash
# æŸ¥çœ‹æ¯ä¸€æ­¥çš„è¾“å‡ºæ–‡ä»¶
cat output/step1_raw.json | python -m json.tool | head -50
```

**æµ‹è¯•å•ä¸ªåŠŸèƒ½**:
```python
# test_fetch.py
import asyncio
from src import RSSSource

async def test():
    source = RSSSource("feeds/RSS_official.opml")
    papers = await source.fetch_papers(limit=5)
    print(f"Fetched {len(papers)} papers")
    for p in papers:
        print(f"- {p.title}")

asyncio.run(test())
```

---

## é™„å½• C: å…³é”®å¤–éƒ¨åº“ç”¨æ³•

### feedparserï¼ˆRSS è§£æï¼‰

åœ¨ `sources/rss.py` å’Œ `sources/rss_parser.py` ä¸­ä½¿ç”¨ã€‚

**æˆ‘ä»¬ä½¿ç”¨çš„åŠŸèƒ½ï¼š**
- `feedparser.parse(content)` â†’ è§£æåçš„ feed å¯¹è±¡
- `feed.entries` â†’ entry å­—å…¸åˆ—è¡¨
- `entry.title`, `entry.link`, `entry.id`
- `entry.summary` / `entry.description` â†’ æ‘˜è¦
- `entry.authors`ï¼ˆ`{name, email}` å­—å…¸åˆ—è¡¨ï¼‰/ `entry.author`ï¼ˆå­—ç¬¦ä¸²ï¼‰
- `entry.published_parsed` / `entry.updated_parsed` â†’ `time.struct_time`
- `entry.tags` â†’ `{term, scheme, label}` å­—å…¸åˆ—è¡¨
- `entry.links` â†’ åŒ…å« `type`, `href`, `rel` çš„é“¾æ¥å­—å…¸åˆ—è¡¨
- `entry.dc_identifier`, `entry.prism_doi` â†’ DOI å­—æ®µ
- `feed.bozo` / `feed.bozo_exception` â†’ è§£æé”™è¯¯æ£€æµ‹
- `entry.content` â€” å¯Œå†…å®¹æ•°ç»„ï¼ˆAtom feedsï¼‰
- `entry.enclosures` â€” åª’ä½“/PDF é™„ä»¶
- `entry.publisher` / `entry.publisher_detail` â€” å‡ºç‰ˆå•†ä¿¡æ¯
- `entry.contributors` â€” å…¶ä»–è´¡çŒ®è€…
- `entry.rights` â€” ç‰ˆæƒ/è®¸å¯
- `entry.source` â€” èšåˆ feed çš„åŸå§‹æ¥æº
- `*_detail` å­—æ®µ â€” `title_detail`, `summary_detail`ï¼ŒåŒ…å«ç±»å‹/è¯­è¨€å…ƒæ•°æ®
- Feed çº§åˆ«: `feed.title`, `feed.subtitle`, `feed.language`, `feed.version`, `feed.encoding`

**å¯ç”¨ä½†å°šæœªä½¿ç”¨ï¼š**
- `entry.created_parsed` â€” åˆ›å»ºæ—¥æœŸ
- HTTP ETag/Last-Modified ç”¨äºæ¡ä»¶ GET

### ezgmailï¼ˆGmail APIï¼‰

åœ¨ `sources/gmail.py` ä¸­ä½¿ç”¨ã€‚

**æˆ‘ä»¬ä½¿ç”¨çš„åŠŸèƒ½ï¼š**
- `ezgmail.init(tokenFile, credentialsFile)` â€” OAuth2 åˆå§‹åŒ–
- `ezgmail.search(query, maxResults)` â†’ `GmailThread` åˆ—è¡¨
- `thread.messages` â€” å»¶è¿ŸåŠ è½½çš„æ¶ˆæ¯åˆ—è¡¨ï¼ˆè§¦å‘ API è°ƒç”¨ï¼‰
- `thread.markAsRead()` â€” æ ‡è®°çº¿ç¨‹å·²è¯»
- `message.id`, `message.subject`, `message.timestamp`, `message.body`
- `message.messageObj` â€” åŸå§‹ Gmail API æ¶ˆæ¯å­—å…¸ï¼ˆç”¨äº HTML æå–ï¼‰
- `message.sender` â€” å‘ä»¶äººä¿¡æ¯
- `message.markAsUnread()` â€” å¤±è´¥æ—¶æ ‡è®°æœªè¯»
- `message.addLabel()` â€” æ ‡ç­¾ç®¡ç†

**å¯ç”¨ä½†å°šæœªä½¿ç”¨ï¼š**
- `message.recipient` â€” æ”¶ä»¶äººä¿¡æ¯
- `message.originalBody` â€” ä¸å»é™¤å¼•ç”¨éƒ¨åˆ†çš„å®Œæ•´æ­£æ–‡
- `message.downloadAttachment()` â€” ä¸‹è½½é™„ä»¶
- `message.removeLabel()` â€” æ ‡ç­¾ç®¡ç†
- `thread.snippet` â€” å¿«é€Ÿé¢„è§ˆæ–‡æœ¬
- `ezgmail.unread()`, `ezgmail.recent()` â€” ä¾¿æ·åŒ…è£…å™¨
- `ezgmail.EMAIL_ADDRESS` â€” å·²ç™»å½•è´¦æˆ·ä¿¡æ¯

**å…³é”®**: ezgmail ä¸æå– HTML æ­£æ–‡ â€” åªæœ‰ `TEXT/PLAIN`ã€‚æˆ‘ä»¬åœ¨ `gmail.py` ä¸­çš„è‡ªå®šä¹‰å‡½æ•° `_extract_html_body()` å’Œ `_find_html_in_payload()` å¡«è¡¥äº†è¿™ä¸€ç©ºç™½ï¼Œé€šè¿‡éå† `message.messageObj` payload æŸ¥æ‰¾å¹¶è§£ç  `TEXT/HTML` éƒ¨åˆ†ã€‚**è¿™äº›å‡½æ•°ä¸å¯åˆ é™¤ã€‚**

### OpenAIï¼ˆAI æ¨¡å—ï¼‰

åœ¨ `ai/keyword_generator.py` å’Œ `filters/ai_filter.py` ä¸­ä½¿ç”¨ã€‚

**æˆ‘ä»¬ä½¿ç”¨çš„åŠŸèƒ½ï¼š**
- `client.chat.completions.create()` â€” LLM äº¤äº’
- JSON æ¨¡å¼ / ç»“æ„åŒ–è¾“å‡ºæç¤º
- æ‰¹å¤„ç†ä»¥æé«˜æ•ˆç‡
- å¹¶è¡Œ API è°ƒç”¨ç”¨äºå…³é”®è¯å€™é€‰ç”Ÿæˆ

### python-dotenvï¼ˆé…ç½®ï¼‰

åœ¨ `config/settings.py` ä¸­ä½¿ç”¨ã€‚

**æˆ‘ä»¬ä½¿ç”¨çš„åŠŸèƒ½ï¼š**
- `load_dotenv(dotenv_path, override=True)` â€” ä» `.env` æ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡ï¼ˆ`.env` ä¼˜å…ˆäºç³»ç»Ÿç¯å¢ƒå˜é‡ï¼‰
- é€šè¿‡ `_ensure_dotenv()` å»¶è¿ŸåŠ è½½ï¼Œç¡®ä¿é…ç½®åœ¨éœ€è¦æ—¶å¯ç”¨

### CrossRef APIï¼ˆå…ƒæ•°æ®è¡¥å……ï¼‰

åœ¨ `sources/crossref.py` ä¸­ä½¿ç”¨ã€‚

**æˆ‘ä»¬ä½¿ç”¨çš„åŠŸèƒ½ï¼š**
- REST API ç”¨äº DOI æŸ¥æ‰¾å’Œæ ‡é¢˜æœç´¢
- é€šè¿‡ `User-Agent` å’Œ `mailto` å¤´éƒ¨ä½¿ç”¨ polite pool è®¿é—®
- å­—æ®µé€‰æ‹©ï¼ˆ`select` å‚æ•°ï¼‰ä»¥å‡å°‘å“åº”è´Ÿè½½
- Jaccard ç›¸ä¼¼åº¦ç”¨äºæ ‡é¢˜åŒ¹é…

### OpenAlex APIï¼ˆå…ƒæ•°æ®è¡¥å……ï¼‰

åœ¨ `sources/openalex.py` ä¸­ä½¿ç”¨ã€‚

**æˆ‘ä»¬ä½¿ç”¨çš„åŠŸèƒ½ï¼š**
- REST API ç”¨äºå¼€æ”¾å…ƒæ•°æ®è¡¥å……
- å€’æ’ç´¢å¼•æ‘˜è¦é‡å»º
- æŒ‰ç›¸å…³æ€§å¾—åˆ†è¿‡æ»¤æ¦‚å¿µ
- Polite pool è®¿é—®
